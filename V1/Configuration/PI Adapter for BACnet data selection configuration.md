---
uid: PIAdapterforBACnetDataSelectionConfiguration
---

# PI Adapter for BACnet data selection configuration

In addition to the data source configuration, you need to provide a data selection configuration to specify the data you want the BACnet adapter to collect from the data sources. 

When you add a data source, the BACnet adapter will discover devices and objects specified in the configuration.

## BACnet device configuration

During data source discovery, device information for all discovered devices is retrieved by the adapter, which is subsequently available through the following REST endpoint using any configuration tool that can execute an HTTP GET command: `http://localhost:5590/api/v1/configuration/<componentId>/DeviceConfiguration/`.

**Note:** The device configuration is generated by the adapter and only supports HTTP GET and DELETE.

The device configuration may be used to choose an appropriate DataCollectionMode when configuring data selection. The following is an example of BACnet device configuration that contains one routed device:
```json
[
  {
    "DeviceIP": "10.12.8.64",
    "DeviceId": 419,
    "NetworkNumber": 20,
    "MacAddress": "ba:cb:00:5a:c4:16",
    "MaxApduSupported": 480,
    "SegmentationSupported": "MaxSegmentation",
    "ServicesSupported": [
      "WhoIs",    
      "IAm",
      "ReadProperty",
      "ReadPropertyMultiple"
    ]
  }
]
```
## REST URLs

| Relative URL | HTTP verb | Action |
| ------------ | --------- | ------ |
| api/v1/configuration/_ComponentId_/DeviceConfiguration  | `GET` | Retrieves the BACnet device configuration |
| api/v1/configuration/_ComponentId_/DeviceConfiguration | `DELETE` | Deletes the BACnet device configuration |

## Configure BACnet data selection

**Note:** You cannot modify BACnet data selection configurations manually. You must use the REST endpoints to add or edit the configuration.

Complete the following to configure the BACnet data selection:

1. Using any text editor, create a file that contains an BACnet data selection in JSON form.
    - For content structure, see [BACnet data selection example](#bacnet-data-selection-example).
    - For a table of all available parameters, see [BACnet data selection](#bacnet-data-selection-parameters).
2. Save the file, for example as _DataSelection.config.json_.
3. Use any of the [Configuration tools](xref:ConfigurationTools) capable of making HTTP requests to execute a POST command with the contents of that file to the following endpoint: `http://localhost:5590/api/v1/configuration/<componentId>/DataSelection/`

    Example using curl (run this command from the same directory where the file is located):

    **Note:** During installation, you can add a single BACnet adapter named BACnet1. The following example uses this component name.

    ```bash
    curl -d "@DataSelection.config.json" -H "Content-Type: application/json" -X PUT "http://localhost:5590/api/v1/configuration/BACnet1/DataSelection"
    ```

## BACnet data selection schema

The full schema definition for the BACnet data selection configuration is in the _BACnet_DataSelection_schema.json_ here:

Windows: *%Program Files%\OSIsoft\Adapters\BACnet\Schemas*

Linux: */opt/OSIsoft/Adapters/BACnet/Schemas*

## BACnet data selection parameters

The following parameters can be used to configure BACnet data selection:

| Parameter     | Required | Type | Description |
|---------------|----------|------|-------------|
| **Selected** | Optional | `boolean` | Use this field to select or clear a measurement. To select an item, set to true and specify a ScheduleId. To remove an item, leave the field empty or set to false.  If not configured, the default value is false. |
| **Name**      | Optional | `string` | Name of the data item collected from the data source. <br><br>Default value: `null` <br>results in **StreamId** value being used also as a **Name** |
| **StreamID** | Optional | `string` | The custom stream ID used to create the streams. If not specified, the BACnet adapter will generate a default stream ID based on the measurement configuration. A properly configured custom stream ID follows these rules:<br><br>Is not case-sensitive.<br>Can contain spaces.<br>Cannot start with two underscores ("__").<br>Can contain a maximum of 100 characters.<br>Cannot use the following characters: / : ? # [ ] @ ! $ & ' ( ) \ * + , ; = % < > &#124;<br>Cannot start or end with a period.<br>Cannot contain consecutive periods.<br>Cannot consist of only periods. |
| **DataFilterId** | Optional | `string` | The ID of the data filter. If not specified, no data filtering will occur. |
| **DeviceIPAddress** | Required | `string` | Device IP Address |
| **ObjectType** | Required | `string` | Any of the [supported object types](xref:PIAdapterforBACnetSupportedFeatures#Object-Types)  |
| **ObjectId** | Required | `number` | BACnet object instance number |
| **DataCollectionMode** | Optional | `string` | Specifies the mode of data collection for the item. Must be one of **Poll**, **SubscribeCov**, or **SubscribeCovProperty**. See [Change Of Value (COV) configuration](xref:BACnetCOVConfiguration) and [Polled data stream configuration](xref:BACnetPolledDataStreamConfiguration) for more information. Default value is **Poll**. |
| **CovIncrement** | Optional | `number` | Used only with **SubscribeCovProperty** DataCollectionMode. Specifies the amount that the configured property must change in order for a new value to be sent by the device. If empty or ommitted, the COV increment to use will be determined by the device. If set to 0, any change in value will result in a new data value being sent.|
| **PropertyIdentifier** | Optional | `string` | Specifies which property to collect from the BACnet object. If left empty, PresentValue is collected. |
| **ScheduleId** | Optional | `string` | Specifies a [schedule ID](xref:SchedulesConfiguration) to which the data selection item is linked. This data item will be collected on the scheduled interval if Selected is set to true.<br>For DataCollectionMode=**Poll**, this is the interval at which this property will be requested from the device.<br>For DataCollectionMode=**SubscribeCov** or **SubscribeCovProperty**, this is the interval at which a re-subscription request will be sent.|

## BACnet data selection example

The following is an example of valid BACnet data selection configuration with different data collection modes. Since the last item has selected set to false, data will not be collected for it.

```json
[
 {
    "Selected": true,
    "Name": "10.12.112.40_14.AnalogInput90",
    "StreamId": "10.12.112.40_14.AnalogInput90",
    "DeviceIPAddress": "10.12.112.40",
    "DeviceId": 14,
    "ObjectType": "AnalogInput",
    "ObjectId": 90,
    "DataCollectionMode": "Poll",
    "ScheduleId": "Schedule1"
  },
  {
    "Selected": true,
    "Name": "10.12.112.40_14.AnalogInput95",
    "StreamId": "10.12.112.40_14.AnalogInput95",
    "DeviceIPAddress": "10.12.112.40",
    "DeviceId": 14,
    "ObjectType": "AnalogInput",
    "ObjectId": 95,
    "DataCollectionMode": "SubscribeCovProperty",
    "PropertyIdentifier": "PresentValue",
    "CovIncrement": 0.5,
    "ScheduleId": "Schedule1"
  },
  {
    "Selected": false,
    "Name": "10.12.112.40_16.AnalogOutput70",
    "StreamId": "10.12.112.40_16.AnalogOutput70",
    "DeviceIPAddress": "10.12.112.40",
    "DeviceId": 16,
    "ObjectType": "AnalogOutput",
    "ObjectId": 70,
    "DataCollectionMode": "SubscribeCov",
    "ScheduleId": "Schedule2"
  }
]
```
## REST URLs

| Relative URL | HTTP verb | Action |
| ------------ | --------- | ------ |
| api/v1/configuration/_ComponentId_/DataSelection  | `GET` | Retrieves the BACnet data selection configuration |
| api/v1/configuration/_ComponentId_/DataSelection  | `PUT` | Configures or updates the BACnet data selection configuration |
| api/v1/configuration/_ComponentId_/DataSelection | `DELETE` | Deletes the BACnet data selection configuration |
| api/v1/configuration/_ComponentId_/DataSelection | `PATCH` | Allows partial updating of configured data selection items. <br>**Note:** The request must be an array containing one or more data selection items. Each data selection item in the array must include its `StreamId` |
| api/v1/configuration/_ComponentId_/DataSelection/_StreamId_ | `PUT` | Updates or creates a new data selection with the specified *StreamId* |
| api/v1/configuration/_ComponentId_/DataSelection/_StreamId_ | `DELETE` | Deletes a specific data selection item of the BACnet data selection configuration |